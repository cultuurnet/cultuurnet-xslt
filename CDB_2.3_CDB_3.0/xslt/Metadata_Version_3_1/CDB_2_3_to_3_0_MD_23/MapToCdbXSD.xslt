<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2005

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce 2005 Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cc="http://www.cultuurdatabank.be/XMLSchema/Culture_CS" xmlns:sc="http://www.cultuurdatabank.be/XMLSchema/SA_comp" xmlns:ad="http://www.cultuurdatabank.be/XMLSchema/address" xmlns:ca="http://www.cultuurdatabank.be/XMLSchema/categorisation" xmlns:ci="http://www.cultuurdatabank.be/XMLSchema/city_area" xmlns:ct="http://www.cultuurdatabank.be/XMLSchema/city_comp" xmlns:co="http://www.cultuurdatabank.be/XMLSchema/country" xmlns:ec="http://www.cultuurdatabank.be/XMLSchema/event_cluster" xmlns:ed="http://www.cultuurdatabank.be/XMLSchema/event_date" xmlns:gc="http://www.cultuurdatabank.be/XMLSchema/gis_comp" xmlns:lc="http://www.cultuurdatabank.be/XMLSchema/language_comp" xmlns:mc="http://www.cultuurdatabank.be/XMLSchema/mail_comp" xmlns:me="http://www.cultuurdatabank.be/XMLSchema/media" xmlns:md="http://www.cultuurdatabank.be/XMLSchema/metadata" xmlns:na="http://www.cultuurdatabank.be/XMLSchema/name_comp" xmlns:no="http://www.cultuurdatabank.be/XMLSchema/note_comp" xmlns:ot="http://www.cultuurdatabank.be/XMLSchema/opening_times" xmlns:or="http://www.cultuurdatabank.be/XMLSchema/organisation" xmlns:pe="http://www.cultuurdatabank.be/XMLSchema/person" xmlns:ph="http://www.cultuurdatabank.be/XMLSchema/phone" xmlns:pr="http://www.cultuurdatabank.be/XMLSchema/price" xmlns:ref="http://www.cultuurdatabank.be/XMLSchema/reference_item" xmlns:rn="http://www.cultuurdatabank.be/XMLSchema/region_nat" xmlns:rel="http://www.cultuurdatabank.be/XMLSchema/relation_item" xmlns:sp="http://www.cultuurdatabank.be/XMLSchema/street_part" xmlns:uc="http://www.cultuurdatabank.be/XMLSchema/url_comp" xmlns:zc="http://www.cultuurdatabank.be/XMLSchema/zip_codes" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns="http://www.cultuurdatabank.com/XMLSchema/CdbXSD/3.0/DRAFT" exclude-result-prefixes="cc sc ad ca ci ct co ec ed gc lc mc me md na no ot or pe ph pr ref rn rel sp uc zc xs">
	<xsl:output method="xml" encoding="UTF-8" indent="yes"/>
	<xsl:template match="/CDB">
		<cdbxml>
			<xsl:attribute name="xsi:schemaLocation">http://www.cultuurdatabank.com/XMLSchema/CdbXSD/3.0/DRAFT //172.16.1.51/xml/XSD/CDB_3_0/CdbXSD_3.0/CdbXSD_3.0/CdbXSD.xsd</xsl:attribute>
			<xsl:for-each select="ec:event_cluster">
				<events>
					<xsl:for-each select="event_cluster_instance">
						<event>
							<xsl:for-each select="md:availablefrom">
								<xsl:attribute name="availablefrom">
									<xsl:value-of select="."/>
								</xsl:attribute>
							</xsl:for-each>
							<xsl:for-each select="md:availableto">
								<xsl:attribute name="availableto">
									<xsl:value-of select="."/>
								</xsl:attribute>
							</xsl:for-each>
							<xsl:for-each select="md:objectid">
								<xsl:attribute name="cdbid">
									<xsl:value-of select="."/>
								</xsl:attribute>
							</xsl:for-each>
							<xsl:for-each select="md:external_identifier">
								<xsl:attribute name="externalid">
									<xsl:value-of select="."/>
								</xsl:attribute>
							</xsl:for-each>
							<calendar>
								<xsl:for-each select="ot:opening_times">
									<timestamps>
										<xsl:for-each select="opening_times_instance">
											<timestamp>
												<xsl:for-each select="time_start">
													<xsl:variable name="time_start" select="."/>
													<xsl:variable name="substringResult" select="substring($time_start, '1', '10')"/>
													<date>
														<xsl:value-of select="$substringResult"/>
													</date>
												</xsl:for-each>
												<xsl:for-each select="time_start">
													<xsl:variable name="time_start1" select="."/>
													<xsl:variable name="substringResult1" select="substring($time_start1, '12')"/>
													<timestart>
														<xsl:value-of select="$substringResult1"/>
													</timestart>
												</xsl:for-each>
												<xsl:for-each select="time_end">
													<xsl:variable name="time_end" select="."/>
													<xsl:variable name="substringResult2" select="substring($time_end, '12')"/>
													<timeend>
														<xsl:value-of select="$substringResult2"/>
													</timeend>
												</xsl:for-each>
											</timestamp>
										</xsl:for-each>
									</timestamps>
								</xsl:for-each>
							</calendar>
							<categories>
								<xsl:for-each select="category">
									<xsl:for-each select="categorisation_instance">
										<xsl:variable name="categorisation_instance" select="."/>
										<xsl:for-each select="label">
											<xsl:for-each select="dutch">
												<publicrange>
													<xsl:for-each select="$categorisation_instance/md:objectid">
														<xsl:attribute name="catid">
															<xsl:value-of select="."/>
														</xsl:attribute>
													</xsl:for-each>
													<xsl:value-of select="."/>
												</publicrange>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
								<themes>
									<xsl:for-each select="category">
										<xsl:for-each select="categorisation_instance">
											<xsl:variable name="categorisation_instance1" select="."/>
											<xsl:for-each select="label">
												<xsl:for-each select="dutch">
													<theme>
														<xsl:for-each select="$categorisation_instance1/md:objectid">
															<xsl:attribute name="catid">
																<xsl:value-of select="."/>
															</xsl:attribute>
														</xsl:for-each>
														<xsl:value-of select="."/>
													</theme>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</themes>
								<types>
									<xsl:for-each select="category">
										<xsl:for-each select="categorisation_instance">
											<xsl:variable name="categorisation_instance2" select="."/>
											<xsl:for-each select="label">
												<xsl:for-each select="dutch">
													<type>
														<xsl:for-each select="$categorisation_instance2/md:objectid">
															<xsl:attribute name="catid">
																<xsl:value-of select="."/>
															</xsl:attribute>
														</xsl:for-each>
														<xsl:value-of select="."/>
													</type>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</types>
							</categories>
							<contactinfo>
								<xsl:for-each select="address">
									<xsl:for-each select="ad:address">
										<xsl:variable name="address" select="."/>
										<xsl:for-each select="address_instance">
											<xsl:variable name="address_instance" select="."/>
											<address>
												<xsl:for-each select="$address/ref:reference_item">
													<xsl:for-each select="main">
														<xsl:attribute name="main">
															<xsl:value-of select="."/>
														</xsl:attribute>
													</xsl:for-each>
												</xsl:for-each>
												<physical>
													<xsl:for-each select="zip_codes">
														<xsl:variable name="zip_codes" select="."/>
														<xsl:for-each select="$address_instance/city_free_text">
															<xsl:variable name="city_free_text" select="."/>
															<xsl:variable name="concatResult" select="concat($zip_codes, '_')"/>
															<xsl:variable name="concatResult1" select="concat($concatResult, $city_free_text)"/>
															<city>
																<xsl:value-of select="$concatResult1"/>
															</city>
														</xsl:for-each>
													</xsl:for-each>
													<xsl:variable name="VEXISTS">
														<xsl:variable name="ExistsResult">
															<xsl:for-each select="country_free_text">
																<xsl:value-of select="true()"/>
															</xsl:for-each>
														</xsl:variable>
														<xsl:choose>
															<xsl:when test="$ExistsResult">
																<xsl:value-of select="'true"/>
															</xsl:when>
															<xsl:otherwise>
																<xsl:value-of select="'false'"/>
															</xsl:otherwise>
														</xsl:choose>
													</xsl:variable>
													xxx<xsl:value-of select="$VEXISTS"></xsl:value-of>zzz
													<country>
														<xsl:variable name="ConditionResult">
															<xsl:choose>
																<xsl:when test="string($VEXISTS)='true'">
																	<xsl:for-each select="country_free_text">
																		<xsl:variable name="country_free_text" select="."/>
																		<xsl:value-of select="$country_free_text"/>
																	</xsl:for-each>
																</xsl:when>
																<xsl:otherwise>
																	<xsl:value-of select="'BE'"/>
																</xsl:otherwise>
															</xsl:choose>
														</xsl:variable>
														<xsl:value-of select="$ConditionResult"/>
													</country>
													<xsl:for-each select="house_number">
														<housenr>
															<xsl:value-of select="."/>
														</housenr>
													</xsl:for-each>
													<xsl:for-each select="street_free_text">
														<street>
															<xsl:value-of select="."/>
														</street>
													</xsl:for-each>
													<xsl:for-each select="zip_codes">
														<zipcode>
															<xsl:value-of select="."/>
														</zipcode>
													</xsl:for-each>
												</physical>
											</address>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
								<xsl:for-each select="mail_comp">
									<xsl:for-each select="mc:mail_comp">
										<xsl:variable name="mail_comp" select="."/>
										<xsl:for-each select="mail_comp_instance">
											<xsl:variable name="mail_comp_instance" select="."/>
											<xsl:for-each select="username">
												<xsl:variable name="username" select="."/>
												<xsl:for-each select="$mail_comp_instance/domain">
													<xsl:variable name="domain" select="."/>
													<xsl:variable name="concatResult2" select="concat($username, '@')"/>
													<xsl:variable name="concatResult3" select="concat($concatResult2, $domain)"/>
													<mail>
														<xsl:value-of select="$concatResult3"/>
														<xsl:for-each select="$mail_comp/ref:reference_item">
															<xsl:for-each select="main">
																<xsl:attribute name="main">
																	<xsl:value-of select="."/>
																</xsl:attribute>
															</xsl:for-each>
														</xsl:for-each>
													</mail>
												</xsl:for-each>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
								<xsl:for-each select="phone">
									<xsl:for-each select="ph:phone">
										<xsl:variable name="phone" select="."/>
										<xsl:for-each select="phone_instance">
											<xsl:variable name="phone_instance" select="."/>
											<xsl:for-each select="number">
												<phone>
													<xsl:for-each select="$phone/ref:reference_item">
														<xsl:for-each select="main">
															<xsl:attribute name="main">
																<xsl:value-of select="."/>
															</xsl:attribute>
														</xsl:for-each>
													</xsl:for-each>
													<xsl:for-each select="$phone_instance/phone_type">
														<xsl:attribute name="type">
															<xsl:value-of select="."/>
														</xsl:attribute>
													</xsl:for-each>
													<xsl:value-of select="."/>
												</phone>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
								<xsl:for-each select="url_comp">
									<xsl:for-each select="uc:url_comp">
										<xsl:variable name="url_comp" select="."/>
										<xsl:for-each select="url_comp_instance">
											<xsl:for-each select="url_value">
												<url>
													<xsl:for-each select="$url_comp/ref:reference_item">
														<xsl:for-each select="main">
															<xsl:attribute name="main">
																<xsl:value-of select="."/>
															</xsl:attribute>
														</xsl:for-each>
													</xsl:for-each>
													<xsl:value-of select="."/>
												</url>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
								</xsl:for-each>
							</contactinfo>
							<eventdetails>
								<eventdetail>
									<xsl:for-each select="lc:language_comp">
										<xsl:for-each select="language_comp_instance">
											<xsl:for-each select="iso_code">
												<xsl:attribute name="lang">
													<xsl:value-of select="."/>
												</xsl:attribute>
											</xsl:for-each>
										</xsl:for-each>
									</xsl:for-each>
									<xsl:for-each select="estimated_time">
										<estimatedtime>
											<xsl:value-of select="."/>
										</estimatedtime>
									</xsl:for-each>
									<xsl:for-each select="md:label">
										<xsl:for-each select="dutch">
											<label>
												<xsl:value-of select="."/>
											</label>
										</xsl:for-each>
									</xsl:for-each>
									<xsl:for-each select="price_standard">
										<xsl:for-each select="price_instance">
											<price>
												<xsl:for-each select="price_value">
													<pricevalue>
														<xsl:value-of select="."/>
													</pricevalue>
												</xsl:for-each>
												<xsl:for-each select="me:media">
													<xsl:for-each select="media_instance">
														<xsl:for-each select="md:short_description">
															<xsl:for-each select="dutch">
																<pricedescription>
																	<xsl:value-of select="."/>
																</pricedescription>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</xsl:for-each>
											</price>
										</xsl:for-each>
									</xsl:for-each>
									<xsl:for-each select="md:short_description">
										<xsl:for-each select="dutch">
											<shortdescription>
												<xsl:value-of select="."/>
											</shortdescription>
										</xsl:for-each>
									</xsl:for-each>
								</eventdetail>
							</eventdetails>
							<xsl:for-each select="md:keywords">
								<keywords>
									<xsl:value-of select="."/>
								</keywords>
							</xsl:for-each>
							<xsl:for-each select="organisation">
								<xsl:for-each select="or:organisation">
									<location>
										<xsl:for-each select="organisation_instance">
											<actor>
												<xsl:for-each select="md:availablefrom">
													<xsl:attribute name="availablefrom">
														<xsl:value-of select="."/>
													</xsl:attribute>
												</xsl:for-each>
												<xsl:for-each select="md:availableto">
													<xsl:attribute name="availableto">
														<xsl:value-of select="."/>
													</xsl:attribute>
												</xsl:for-each>
												<xsl:for-each select="md:objectid">
													<xsl:attribute name="cdbid">
														<xsl:value-of select="."/>
													</xsl:attribute>
												</xsl:for-each>
												<xsl:for-each select="md:external_identifier">
													<xsl:attribute name="externalid">
														<xsl:value-of select="."/>
													</xsl:attribute>
												</xsl:for-each>
												<actordetails>
													<actordetail>
														<xsl:for-each select="md:label">
															<xsl:for-each select="dutch">
																<label>
																	<xsl:value-of select="."/>
																</label>
															</xsl:for-each>
														</xsl:for-each>
														<media>
															<xsl:for-each select="me:media">
																<xsl:for-each select="media_instance">
																	<file>
																		<xsl:for-each select="md:objectid">
																			<xsl:attribute name="cdbid">
																				<xsl:value-of select="."/>
																			</xsl:attribute>
																		</xsl:for-each>
																		<xsl:for-each select="copyright">
																			<copyright>
																				<xsl:value-of select="."/>
																			</copyright>
																		</xsl:for-each>
																		<xsl:for-each select="file">
																			<filename>
																				<xsl:value-of select="."/>
																			</filename>
																		</xsl:for-each>
																		<xsl:for-each select="media_type">
																			<filetype>
																				<xsl:value-of select="."/>
																			</filetype>
																		</xsl:for-each>
																		<xsl:for-each select="md:label">
																			<xsl:for-each select="dutch">
																				<label>
																					<xsl:value-of select="."/>
																				</label>
																			</xsl:for-each>
																		</xsl:for-each>
																	</file>
																</xsl:for-each>
															</xsl:for-each>
														</media>
														<xsl:for-each select="md:short_description">
															<xsl:for-each select="dutch">
																<shortdescription>
																	<xsl:value-of select="."/>
																</shortdescription>
															</xsl:for-each>
														</xsl:for-each>
													</actordetail>
												</actordetails>
												<contactinfo>
													<address>
														<xsl:for-each select="address">
															<xsl:for-each select="ad:address">
																<xsl:for-each select="ref:reference_item">
																	<xsl:for-each select="main">
																		<xsl:attribute name="main">
																			<xsl:value-of select="."/>
																		</xsl:attribute>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
														<physical>
															<xsl:for-each select="address">
																<xsl:for-each select="ad:address">
																	<xsl:for-each select="address_instance">
																		<xsl:variable name="address_instance1" select="."/>
																		<xsl:for-each select="zip_codes">
																			<xsl:variable name="zip_codes1" select="."/>
																			<xsl:for-each select="$address_instance1/city_free_text">
																				<xsl:variable name="city_free_text1" select="."/>
																				<xsl:variable name="concatResult4" select="concat($zip_codes1, '_')"/>
																				<xsl:variable name="concatResult5" select="concat($concatResult4, $city_free_text1)"/>
																				<city>
																					<xsl:value-of select="$concatResult5"/>
																				</city>
																			</xsl:for-each>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
															<xsl:for-each select="address">
																<xsl:for-each select="ad:address">
																	<xsl:for-each select="address_instance">
																		<xsl:for-each select="country_free_text">
																			<country>
																				<xsl:value-of select="."/>
																			</country>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
															<xsl:for-each select="address">
																<xsl:for-each select="ad:address">
																	<xsl:for-each select="address_instance">
																		<xsl:for-each select="house_number">
																			<housenr>
																				<xsl:value-of select="."/>
																			</housenr>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
															<xsl:for-each select="address">
																<xsl:for-each select="ad:address">
																	<xsl:for-each select="address_instance">
																		<xsl:for-each select="street_free_text">
																			<street>
																				<xsl:value-of select="."/>
																			</street>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
															<xsl:for-each select="address">
																<xsl:for-each select="ad:address">
																	<xsl:for-each select="address_instance">
																		<xsl:for-each select="zip_codes">
																			<zipcode>
																				<xsl:value-of select="."/>
																			</zipcode>
																		</xsl:for-each>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</physical>
													</address>
													<xsl:for-each select="mail_comp">
														<xsl:for-each select="mc:mail_comp">
															<xsl:variable name="mail_comp1" select="."/>
															<xsl:for-each select="mail_comp_instance">
																<xsl:variable name="mail_comp_instance1" select="."/>
																<xsl:for-each select="username">
																	<xsl:variable name="username1" select="."/>
																	<xsl:for-each select="$mail_comp_instance1/domain">
																		<xsl:variable name="domain1" select="."/>
																		<xsl:variable name="concatResult6" select="concat($username1, '@')"/>
																		<xsl:variable name="concatResult7" select="concat($concatResult6, $domain1)"/>
																		<mail>
																			<xsl:value-of select="$concatResult7"/>
																			<xsl:for-each select="$mail_comp1/ref:reference_item">
																				<xsl:for-each select="main">
																					<xsl:attribute name="main">
																						<xsl:value-of select="."/>
																					</xsl:attribute>
																				</xsl:for-each>
																			</xsl:for-each>
																		</mail>
																	</xsl:for-each>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
													<xsl:for-each select="phone">
														<xsl:for-each select="ph:phone">
															<xsl:variable name="phone1" select="."/>
															<xsl:for-each select="phone_instance">
																<xsl:for-each select="number">
																	<phone>
																		<xsl:for-each select="$phone1/ref:reference_item">
																			<xsl:for-each select="main">
																				<xsl:attribute name="main">
																					<xsl:value-of select="."/>
																				</xsl:attribute>
																			</xsl:for-each>
																		</xsl:for-each>
																		<xsl:value-of select="."/>
																	</phone>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
													<xsl:for-each select="url_comp">
														<xsl:for-each select="uc:url_comp">
															<xsl:variable name="url_comp1" select="."/>
															<xsl:for-each select="url_comp_instance">
																<xsl:for-each select="url_value">
																	<url>
																		<xsl:for-each select="$url_comp1/ref:reference_item">
																			<xsl:for-each select="main">
																				<xsl:attribute name="main">
																					<xsl:value-of select="."/>
																				</xsl:attribute>
																			</xsl:for-each>
																		</xsl:for-each>
																		<xsl:value-of select="."/>
																	</url>
																</xsl:for-each>
															</xsl:for-each>
														</xsl:for-each>
													</xsl:for-each>
												</contactinfo>
												<xsl:for-each select="md:keywords">
													<keywords>
														<xsl:value-of select="."/>
													</keywords>
												</xsl:for-each>
											</actor>
										</xsl:for-each>
									</location>
								</xsl:for-each>
							</xsl:for-each>
						</event>
					</xsl:for-each>
				</events>
			</xsl:for-each>
			<xsl:for-each select="ca:categorisation">
				<categorisation/>
			</xsl:for-each>
		</cdbxml>
	</xsl:template>
</xsl:stylesheet>
